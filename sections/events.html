---
layout: default
title: "Events - Viaduct Echo"
permalink: /events/
---

<div class="content-wrapper">
  <div class="row">
    <div class="col-12">
      <!-- Loading Indicator -->
      <div id="loadingIndicator" class="text-center my-5">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-2">Loading events...</p>
      </div>

      <!-- Events Grid -->
      <div id="eventsGrid" class="row" style="display: none;">
        <!-- Events will be inserted here by JavaScript -->
      </div>

      <!-- No Events Message -->
      <div id="noEventsMessage" class="alert alert-info" role="alert" style="display: none;">
        <h4 class="alert-heading">No Events Found</h4>
        <p>There are currently no events matching your filters. Try adjusting your search criteria.</p>
      </div>

      <!-- Error Message -->
      <div id="errorMessage" class="alert alert-danger" role="alert" style="display: none;">
        <h4 class="alert-heading">Error Loading Events</h4>
        <p id="errorText">Unable to load events. Please try again later.</p>
      </div>
    </div>
  </div>
</div>

<script>
  let allEvents = [];

  // Load events data
  async function loadEvents() {
    try {
      const response = await fetch('{{ site.baseurl }}/api/events.json');
      if (!response.ok) throw new Error('Failed to load events');
      const data = await response.json();
      allEvents = data.events;

      displayEvents(allEvents);

      document.getElementById('loadingIndicator').style.display = 'none';
      document.getElementById('eventsGrid').style.display = 'flex';
    } catch (error) {
      console.error('Error loading events:', error);
      document.getElementById('loadingIndicator').style.display = 'none';
      document.getElementById('errorMessage').style.display = 'block';
      document.getElementById('errorText').textContent = error.message;
    }
  }

  // Display events
  function displayEvents(events) {
    const grid = document.getElementById('eventsGrid');
    const noEventsMsg = document.getElementById('noEventsMessage');

    grid.innerHTML = '';

    if (events.length === 0) {
      grid.style.display = 'none';
      noEventsMsg.style.display = 'block';
      return;
    }

    noEventsMsg.style.display = 'none';
    grid.style.display = 'flex';

    events.forEach(event => {
      const eventCard = createEventCard(event);
      grid.appendChild(eventCard);
    });
  }

  // Create event card HTML
  function createEventCard(event) {
    const col = document.createElement('div');
    col.className = 'col-md-6 col-lg-4 mb-4';

    const eventDate = new Date(event.start_datetime);
    const dateStr = eventDate.toLocaleDateString('en-GB', {
      weekday: 'short',
      day: 'numeric',
      month: 'short',
      year: 'numeric'
    });
    const timeStr = eventDate.toLocaleTimeString('en-GB', {
      hour: '2-digit',
      minute: '2-digit'
    });

    const formatPrice = (price) => {
      if (typeof price === 'number') {
        const formatted = price.toFixed(2);
        // Remove .00 for whole numbers
        return formatted.endsWith('.00') ? formatted.slice(0, -3) : formatted;
      }
      return price;
    };

    const priceText = event.is_free ? 'Free' :
                      (event.price_min && event.price_max) ? `£${formatPrice(event.price_min)} - £${formatPrice(event.price_max)}` :
                      event.price_min ? `£${formatPrice(event.price_min)}` : 'See website for prices';

    // Create Google Maps URL
    const mapsUrl = event.venue ?
      `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(event.venue.name + ', ' + event.venue.postcode)}` :
      '';

    col.innerHTML = `
      <div class="card event-card">
        <div class="event-image-container">
          ${event.image_url && event.ticket_url ?
            `<a href="${event.ticket_url}" target="_blank" rel="noopener">
              <img src="${event.image_url}" class="card-img-top event-image" alt="${event.title}">
            </a>` :
            event.image_url ?
              `<img src="${event.image_url}" class="card-img-top" alt="${event.title}">` :
              ''
          }
        </div>
        <div class="card-body">
          ${event.ticket_url ?
            `<h5 class="card-title"><a href="${event.ticket_url}" target="_blank" rel="noopener" class="event-title-link">${event.title}</a></h5>` :
            `<h5 class="card-title">${event.title}</h5>`
          }
          <p class="card-text text-muted event-date">
            <i class="far fa-calendar"></i> ${dateStr}
          </p>
          <p class="card-text text-muted event-time">
            <i class="far fa-clock"></i> ${timeStr}
          </p>
          <p class="card-text text-muted event-venue">
            ${event.venue ?
              `<i class="fas fa-map-marker-alt"></i> <a href="${mapsUrl}" target="_blank" rel="noopener" class="venue-link">${event.venue.name}</a>` :
              ''
            }
          </p>
          <p class="card-text event-price">
            <span class="badge ${event.is_free ? 'bg-success' : 'bg-secondary'}">${priceText}</span>
          </p>
        </div>
      </div>
    `;

    return col;
  }

  // Load events on page load
  loadEvents();
</script>

<style>
  /* Fix elastic scroll background */
  html {
    background: #333738;
  }

  body {
    background: #333738;
  }

  /* Hide sidebar and make content full-width for events page */
  body.layout-default .docs-sidebar {
    display: none;
  }

  body.layout-default .docs-content {
    margin-left: 0;
    width: 100%;
    max-width: 100%;
    background: #333738;
  }

  body.layout-default .docs-layout {
    background: #333738;
  }

  .content-wrapper {
    background: #333738;
  }

  .row {
    background: #333738;
  }

  .col-12 {
    background: #333738;
  }

  #eventsGrid {
    background: #333738;
  }

  /* Use CSS Grid to align all cards in the row */
  #eventsGrid {
    display: grid !important;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 1.5rem;
    align-items: start;
    background: #333738;
  }

  #eventsGrid > div {
    display: contents;
    background: #333738;
  }

  .col-md-6, .col-lg-4, .mb-4 {
    background: #333738 !important;
  }

  /* Force all Bootstrap column classes to have dark background */
  [class*="col-"] {
    background: #333738 !important;
  }

  .event-card {
    display: grid;
    grid-template-rows: auto auto auto auto auto auto;
    align-items: start;
    height: 100%;
    background: #333738 !important;
    border: none;
  }

  .event-card .card {
    background: #333738 !important;
    border: none;
  }

  /* Override all card backgrounds */
  .card, .card * {
    background-color: transparent !important;
  }

  .event-image-container, .event-image-container * {
    background: #333738 !important;
  }

  .event-card {
    background: #333738 !important;
  }

  /* Image container with fixed height for vertical centering */
  .event-image-container {
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 400px;
    max-height: 600px;
    overflow: hidden;
    border: none;
    background: #333738 !important;
  }

  .event-image-container a {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    background: #333738 !important;
  }

  .card-img-top {
    width: 100%;
    height: auto;
    max-height: 600px;
    object-fit: contain;
    display: block;
    border: none;
    background: transparent;
  }

  /* Ensure all card elements have dark background */
  .card {
    background: #333738 !important;
  }

  .event-image {
    transition: opacity 0.2s;
  }

  .event-image:hover {
    opacity: 0.85;
  }

  .card-body {
    padding: 0.5rem;
    background: #333738 !important;
  }

  .card-title {
    font-size: 1.65rem;
    font-weight: 600;
    line-height: 1.2;
    min-height: 2.1rem;
    margin-bottom: 0.375rem;
    color: #f8f9fa;
    background: transparent !important;
  }

  .event-date,
  .event-time,
  .event-venue,
  .event-price {
    margin-bottom: 0.25rem;
    line-height: 0.65;
    color: #CCCCCC;
    background: transparent !important;
  }

  .card-text {
    line-height: 0.65;
    color: #CCCCCC;
    background: transparent !important;
  }

  .text-muted {
    color: #CCCCCC !important;
    background: transparent !important;
  }

  p {
    background: transparent !important;
  }

  /* Fix footer background */
  footer {
    background: #333738 !important;
  }

  .footer {
    background: #333738 !important;
  }

  .event-title-link {
    color: inherit;
    text-decoration: none;
    transition: color 0.2s;
  }

  .event-title-link:hover {
    color: #0d6efd;
    text-decoration: none;
  }

  .venue-link {
    color: #CCCCCC;
    text-decoration: none;
    transition: color 0.2s;
  }

  .venue-link:hover {
    color: #82d4e3;
    text-decoration: underline;
  }

  .badge {
    font-size: 0.975rem;
    margin-right: 0.25rem;
    color: #f8f9fa !important;
    padding: 0.45em 0.75em;
    background-color: #29457A !important;
  }
</style>
